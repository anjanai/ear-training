<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8"/>
    <title> Ear-training </title>
    <script src="https://unpkg.com/tone"></script>
    <script src="https://unpkg.com/jquery"></script>
    <script>
      var sampler;

      function sleep(ms) {
	  return new Promise(resolve => setTimeout(resolve, ms));
      }

      function createSampler() {
	  var sampler = new Tone.Sampler({
	      urls: {
		  'A4': "A4.ogg",
		  'C4': "C4.ogg",
		  'D#4': "Ds4.ogg",
		  'F#4': "Fs4.ogg",
	      },
	      baseUrl: "https://tonejs.github.io/audio/salamander/",
	      onload: () => { console.log ("loaded"); }
	  }).toDestination();
	  sampler.context._context.resume() // necessary for Safari
	  return sampler;
      }

      
      async function playtone(note) {
	  if (!sampler) sampler = createSampler();
	  while (!sampler.loaded) await sleep(200);
	  sampler.triggerAttackRelease("A4", "2n");
      }
    </script>

  </head>
  <body>
    <button onClick="playtone()">Play</button> 
  </body>
</html>
